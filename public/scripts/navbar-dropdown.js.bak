document.addEventListener("DOMContentLoaded", function () {
	const btn = document.getElementById("nav-menu-btn");
	const menu = document.getElementById("filter-sort-menu");

	if (!btn || !menu) return;

	function openMenu() {
		menu.setAttribute("aria-hidden", "false");
		btn.setAttribute("aria-expanded", "true");
		menu.style.display = "block";
		document.body.classList.add("dropdown-open");
	}

	function closeMenu() {
		menu.setAttribute("aria-hidden", "true");
		btn.setAttribute("aria-expanded", "false");
		menu.style.display = "none";
		document.body.classList.remove("dropdown-open");
	}

	function toggleMenu(e) {
		e.stopPropagation();
		if (menu.getAttribute("aria-hidden") === "true") {
			openMenu();
		} else {
			closeMenu();
		}
	}

	btn.addEventListener("click", toggleMenu);

	// Close on outside click
	document.addEventListener("click", function (e) {
		if (!menu.contains(e.target) && !btn.contains(e.target)) {
			closeMenu();
		}
	});

	// Close on Escape key
	document.addEventListener("keydown", function (e) {
		if (e.key === "Escape") {
			closeMenu();
		}
	});

	// Initialize menu as hidden
	closeMenu();
});
