document.addEventListener("DOMContentLoaded", function () {
	const btn = document.getElementById("nav-menu-btn");
	const menu = document.getElementById("filter-sort-menu");

	if (!btn || !menu) return;

	// Helper functions
	function setMenuState(isOpen) {
		menu.setAttribute("aria-hidden", String(!isOpen));
		btn.setAttribute("aria-expanded", String(isOpen));
		menu.style.display = isOpen ? "block" : "none";
		document.body.classList.toggle("dropdown-open", isOpen);
	}

	function toggleMenu(e) {
		e.stopPropagation();
		const isHidden = menu.getAttribute("aria-hidden") === "true";
		setMenuState(isHidden);
	}

	function handleOutsideClick(e) {
		if (!menu.contains(e.target) && !btn.contains(e.target)) {
			setMenuState(false);
		}
	}

	function handleKeyDown(e) {
		if (e.key === "Escape") {
			setMenuState(false);
		}
	}

	// Event listeners
	btn.addEventListener("click", toggleMenu);
	document.addEventListener("click", handleOutsideClick);
	document.addEventListener("keydown", handleKeyDown);

	// Initialize menu as hidden
	setMenuState(false);
});
