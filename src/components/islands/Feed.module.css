/* Feed.module.css */

/* --- CLEAN, SINGLE-CONTAINER NAVBAR & DROPDOWN LAYOUT --- */
/* Removed local width variables in favor of global tokens */

.navbar-header-row {
	position: relative;
	max-width: var(--navbar-max-width);
	width: 100%;
	margin: 0 auto;
	box-sizing: border-box;
	z-index: 1000;
}

#filter-sort-menu {
	position: absolute;
	left: 0;
	right: 0;
	top: 100%;
	box-sizing: border-box;
	z-index: 999;
	border-radius: var(--radius-unified);
}

/* --- FEED & POSTS --- */
#posts-feed,
.post-card,
.expanded-card {
	max-width: var(--feed-max-width);
	width: 100%;
	margin-left: auto;
	margin-right: auto;
	box-sizing: border-box;
	scrollbar-gutter: stable both-edges;
}

#posts-feed {
	display: flex;
	flex-direction: column;
	gap: var(--fluid-space-m); /* Consistent spacing */
	list-style: none;
	max-width: clamp(320px, 96vw, var(--feed-max-width)); /* Smooth scaling */
	width: 100%;
	margin: 0 auto;
	padding-left: var(--fluid-space-s);
	padding-right: var(--fluid-space-s);
}

@media (max-width: 600px) {
	#posts-feed {
		padding-left: var(--fluid-space-xs);
		padding-right: var(--fluid-space-xs);
	}
}

.post-card,
.expanded-card {
	border-radius: var(--radius-unified);
	box-shadow: var(--shadow-card);
	border: var(--border-unified);
	background: var(--color-card-bg);
	margin-bottom: var(--fluid-space-m);
	transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
	overflow: hidden;
}

#posts-feed > * {
	width: 100%;
	box-sizing: border-box;
}

.single-column-feed {
	display: flex;
	flex-direction: column;
	gap: var(--fluid-space-s); /* [RULE: Spacing] */
	min-height: 1px;
	min-width: 0;
	width: 100%;
	max-width: var(--feed-max-width);
	margin: 0 auto;
	box-sizing: border-box;
	border-radius: var(--radius-unified);
	background: var(--color-card-bg);
	gap: var(--fluid-space-s);
}

.post-card {
	outline: none;
	min-width: 0;
	min-height: 160px; /* Reduced for cleaner layout */
	position: relative;
}

.post-card:hover,
.post-card:focus {
	box-shadow: var(--shadow-card-hover);
	border-color: var(--color-accent);
	transform: translateY(-2px); /* Subtle lift effect */
}

.post-card-inner {
	border-radius: var(--radius-unified);
	background: var(--color-card-bg);
	box-shadow: none;
	padding: clamp(
		var(--fluid-space-s),
		3vw,
		var(--fluid-space-l)
	); /* Reduced padding */
	display: flex;
	flex-direction: column;
	gap: var(--fluid-space-s); /* Reduced gap */
	height: 100%;
	position: relative;
}

.post-card-inner > * {
	position: relative;
	z-index: auto;
}

.post-card-content {
	flex: 1;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: var(--fluid-space-s);
}

/* Improved content spacing for horizontal layout */
.post-card-inner.with-thumbnail {
	display: flex;
	flex-direction: row !important; /* Override the column default */
	align-items: flex-start;
	gap: clamp(var(--fluid-space-m), 3vw, var(--fluid-space-l));
}

.post-card-inner.with-thumbnail .post-card-content {
	flex: 1;
	gap: clamp(var(--fluid-space-xs), 2vw, var(--fluid-space-s));
	padding-right: 0; /* Remove extra padding */
	order: 0; /* Content comes first (left side) */
}

/* Thumbnail container styles */
.post-card-thumbnail {
	flex-shrink: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	width: clamp(120px, 20vw, 180px);
	height: clamp(120px, 20vw, 180px);
	border-radius: var(--radius-unified);
	overflow: hidden;
	background: var(--color-bg-subtle);
	border: var(--border-unified);
	position: relative;
	order: 1; /* Thumbnail comes second (right side) */
	aspect-ratio: 1; /* Maintain square aspect ratio */
}

.post-card-thumbnail::before {
	content: "";
	position: absolute;
	top: 50%;
	left: 50%;
	width: 24px;
	height: 24px;
	border: 2px solid var(--color-text-muted);
	border-radius: 50%;
	border-top-color: transparent;
	animation: spin 1s linear infinite;
	transform: translate(-50%, -50%);
	opacity: 0;
	z-index: 1;
}

.post-card-thumbnail.loading::before {
	opacity: 1;
}

@keyframes spin {
	to {
		transform: translate(-50%, -50%) rotate(360deg);
	}
}

/* Thumbnail image styles */
.post-thumb-large {
	width: 100%;
	height: 100%;
	object-fit: cover;
	object-position: center;
	transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
	border-radius: var(--radius-unified);
	background: var(--color-bg-subtle);
}

.post-card:hover .post-thumb-large {
	transform: scale(1.05);
}

/* Responsive adjustments for thumbnails */
@media (max-width: 768px) {
	.post-card-inner.with-thumbnail {
		/* Keep horizontal layout, just smaller */
		gap: var(--fluid-space-s);
	}

	.post-card-thumbnail {
		width: clamp(80px, 15vw, 120px);
		height: clamp(80px, 15vw, 120px);
		aspect-ratio: 1; /* Keep square on mobile */
	}
}

@media (max-width: 480px) {
	.post-card-inner.with-thumbnail {
		gap: var(--fluid-space-xs);
	}

	.post-card-thumbnail {
		width: clamp(60px, 12vw, 90px);
		height: clamp(60px, 12vw, 90px);
		aspect-ratio: 1; /* Keep square on small screens */
	}

	/* Reduce padding on very small screens */
	.post-card-inner {
		padding: var(--fluid-space-s);
	}
}

/* === TYPOGRAPHY HIERARCHY SYSTEM === */
/* Design Principles:
 * 1. Visual Hierarchy: Title (1.125-1.5rem) → Meta (0.625-0.75rem) → Body (0.75-0.9375rem) → Actions
 * 2. Line Height: Tight for titles (1.3-1.35), Optimal for body (1.45-1.5)
 * 3. Font Weight: Semi-bold titles (600), Regular meta/body (400)
 * 4. Color Hierarchy: Full opacity titles, 60% meta, 80% body
 * 5. Text Clamping: 2 lines titles, 2-4 lines descriptions based on layout
 * 6. Responsive Scaling: Proportional reduction with graceful mobile fallbacks
 */

/* Primary Title - Hero of the card */
.post-card .title,
.post-card-content h2,
.post-card-content .title {
	font-family: var(--font-family-heading);
	font-size: clamp(1.125rem, 2.2vw, 1.5rem); /* Reduced for better hierarchy */
	font-weight: 600; /* Reduced from 700 for better readability */
	line-height: 1.3; /* Improved for readability */
	margin: 0 0 0.25rem 0; /* Subtle bottom margin for breathing room */
	color: var(--color-text);
	letter-spacing: -0.01em; /* Subtle tracking */
	word-break: break-word;
	display: -webkit-box;
	-webkit-line-clamp: 2; /* Max 2 lines for consistent layout */
	line-clamp: 2;
	-webkit-box-orient: vertical;
	overflow: hidden;
}

.post-card .title a,
.post-card-content h2 a,
.post-card-content .title a {
	color: inherit;
	text-decoration: none;
	transition: color 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.post-card .title a:hover,
.post-card-content h2 a:hover,
.post-card-content .title a:hover {
	color: var(--color-accent);
}

/* Meta Information - Date/Time stamps */
.post-card .date-created,
.post-card .date-updated,
.post-card-content .date-created,
.post-card-content .date-updated {
	color: var(--color-text-muted);
	font-size: clamp(0.6875rem, 1.4vw, 0.75rem); /* Much smaller, more subtle */
	font-weight: 400; /* Regular weight for supporting info */
	margin: 0 0 0.5rem 0; /* Reduced margin for tighter hierarchy */
	opacity: 0.6; /* More subtle transparency */
	letter-spacing: 0.03em; /* Slightly wider tracking for legibility */
	text-transform: uppercase;
	font-family: var(--font-family-base);
	line-height: 1.1; /* Tighter line height */
}

/* Body Text - Description content */
.post-description {
	color: var(--color-text-muted);
	font-size: clamp(
		0.875rem,
		1.6vw,
		0.9375rem
	); /* Reduced for better hierarchy */
	font-weight: 400;
	line-height: 1.5; /* Optimal for readability */
	margin: 0 0 1rem 0; /* Clear separation from actions */
	padding: 0;
	word-break: break-word;
	flex: 1;
	opacity: 0.8; /* Slightly more muted to create better hierarchy */

	/* Smart text truncation for consistent layouts */
	display: -webkit-box;
	-webkit-line-clamp: 3; /* Max 3 lines for description */
	line-clamp: 3;
	-webkit-box-orient: vertical;
	overflow: hidden;
}

#feed-loader {
	text-align: center;
	margin: 0;
	padding: 0;
	color: #888;
	display: block;
}

/* Expanded card alignment */
.expanded-card[class*="post-card"],
.expanded-card[class^="post-card"],
.expanded-card[class*="_post-card_"],
.expanded-card[class^="_post-card_"],
[class*="post-card"].expanded-card,
[class^="post-card"].expanded-card,
[class*="_post-card_"].expanded-card,
[class^="_post-card_"].expanded-card {
	margin-left: auto;
	margin-right: auto;
	width: 100%;
	max-width: var(--feed-max-width);
	box-sizing: border-box;
	box-shadow: 0 4px 32px #0002, 0 0 0 2px #39ff14;
	z-index: 10;
	position: relative;
	min-height: 320px;
}

.expanded-card:hover {
	box-shadow: 0 8px 48px #0003, 0 0 0 2px #39ff14;
}

.expanded-card .post-thumb-large {
	width: 240px;
	height: 240px;
	max-width: 40vw;
	max-height: 40vw;
	display: block;
	margin: 0 2rem 0 0;
	border-radius: var(--radius-unified);
	box-shadow: var(--shadow-elevation-2);
}

.expanded-content {
	padding: var(--fluid-space-l) var(--fluid-space-m) var(--fluid-space-m)
		var(--fluid-space-m);
	border-top: var(--border-unified);
	border-radius: 0 0 var(--radius-unified) var(--radius-unified);
}

.close-btn {
	position: absolute;
	top: 1rem;
	right: 1.5rem;
	/* Use unified button system - no color overrides */
	border-radius: var(--radius-pill);
	padding: var(--space-2) var(--space-4);
	font-size: 1em;
	font-weight: 700;
	cursor: pointer;
	z-index: 20;
	box-shadow: var(--shadow-elevation-2);
	/* All color/background/hover states come from global unified system */
}

/* --- FEED BUTTON INTEGRATION --- */
/*
  Feed buttons use the global unified button system from /src/assets/global.css
  Only minimal layout adjustments are made here - all visual styling (colors, hover states, HDR effects)
  come from the global system and the dynamic accent color tokens.
*/

/* Feed-specific button layout adjustments only */
.feed-cta {
	margin: 0 var(--fluid-space-s) var(--fluid-space-xs) 0;
}

/* Enhanced card visual refinements */
.post-card::before {
	content: "";
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: 3px;
	background: linear-gradient(90deg, var(--color-accent), transparent);
	border-radius: var(--radius-unified) var(--radius-unified) 0 0;
	opacity: 0;
	transition: opacity 0.3s ease;
}

.post-card:hover::before {
	opacity: 1;
}

/* Card content fade-in animation */
@keyframes cardFadeIn {
	from {
		opacity: 0;
		transform: translateY(10px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

.post-card {
	animation: cardFadeIn 0.4s ease-out;
}

/* Enhanced focus states for accessibility */
.post-card:focus-within {
	outline: 2px solid var(--color-accent);
	outline-offset: 2px;
}

/* Typography micro-enhancements */
.post-card .title::after {
	content: "";
	position: absolute;
	bottom: -2px;
	left: 0;
	width: 0;
	height: 2px;
	background: var(--color-accent);
	transition: width 0.3s ease;
}

.post-card:hover .title::after {
	width: 100%;
}

.post-card .title {
	position: relative;
	display: inline-block;
}

/* Responsive typography scaling - ultra-small screens */
@media (max-width: 480px) {
	.post-card-inner {
		padding: var(--fluid-space-m);
		gap: var(--fluid-space-s);
	}

	/* Ultra-small screen typography refinements */
	.post-card .title,
	.post-card-content h2,
	.post-card-content .title {
		font-size: clamp(
			0.9375rem,
			3vw,
			1.0625rem
		); /* Further reduced for very small screens */
		line-height: 1.35;
		margin-bottom: 0.1875rem;
	}

	.post-card .date-created,
	.post-card .date-updated,
	.post-card-content .date-created,
	.post-card-content .date-updated {
		font-size: 0.625rem; /* Very small and consistent on tiny screens */
		margin-bottom: 0.375rem;
		opacity: 0.6;
	}

	.post-description {
		font-size: clamp(
			0.75rem,
			2vw,
			0.8125rem
		); /* Smaller for ultra-small screens */
		line-height: 1.45;
		-webkit-line-clamp: 3; /* Balanced for very small screens */
		line-clamp: 3;
		opacity: 0.8;
	}
}

/* Dark mode specific enhancements */
[data-theme="dark"] .post-card {
	background: var(--color-card-bg);
	border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .post-card:hover {
	border-color: var(--color-accent);
	box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3),
		0 0 0 1px rgba(var(--color-accent-rgb, 57, 255, 20), 0.2);
}

[data-theme="dark"] .post-thumb-large {
	border-color: rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .post-thumb-large:hover {
	box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 4px 8px rgba(0, 0, 0, 0.2);
}
